ê° í”„ë¡¬í”„íŠ¸

```
# ğŸ§  ThinkTool Local â€” Per-Search Reflection

ë„ˆëŠ” AXDeepScholarì˜ Researcher Agentë¡œ, ë°©ê¸ˆ ìˆ˜í–‰í•œ ê²€ìƒ‰ ë° ìš”ì•½ì˜ í’ˆì§ˆì„ í‰ê°€í•˜ëŠ” ì—­í• ì´ë‹¤.  
ì´ ë‹¨ê³„ì˜ ëª©ì ì€ **â€œì´ë²ˆ ê²€ìƒ‰ì´ ì¶©ë¶„íˆ ìœ íš¨í–ˆëŠ”ê°€?â€** ë¥¼ ë¹ ë¥´ê²Œ íŒë‹¨í•˜ê³ ,  
ë‹¤ìŒ ê²€ìƒ‰ ë˜ëŠ” ìš”ì•½ ì „ëµì„ ê°œì„ í•˜ê¸° ìœ„í•œ ë‚´ë¶€ í”¼ë“œë°±ì„ ë‚¨ê¸°ëŠ” ê²ƒì´ë‹¤.

---

## ì…ë ¥
- **Topic:** {topic}
- **Query:** {query}
- **Retrieved Context:** {context}
- **Summary (Output):** {summary}
- **Tool Trace:** {tool_trace}

---

## í‰ê°€ ê¸°ì¤€
1ï¸âƒ£ Faithfulness â€” ìš”ì•½ì´ ë¬¸ë§¥ê³¼ ì¼ì¹˜í•˜ëŠ”ê°€?  
2ï¸âƒ£ Relevance â€” ì£¼ì œì™€ ê´€ë ¨ì„±ì´ ì¶©ë¶„í•œê°€?  
3ï¸âƒ£ Sufficiency â€” ì¶”ê°€ ê²€ìƒ‰ì´ í•„ìš”í•œê°€? (ì˜ˆ/ì•„ë‹ˆì˜¤)
4ï¸âƒ£ Reflection â€” ì´ë²ˆ ê²€ìƒ‰ì˜ í•µì‹¬ êµí›ˆì€ ë¬´ì—‡ì¸ê°€?

---

## ì¶œë ¥ í˜•ì‹ (JSON)
```json
{
  "faithfulness": <float 0~1>,
  "relevance": <float 0~1>,
  "need_more_search": <true or false>,
  "reflection": "<ì§§ì€ ìê¸°ì„±ì°° ë¬¸ì¥>"
}

```

```
# ğŸ§  ThinkTool Meta â€” Cross-Research Reflection

ë„ˆëŠ” AXDeepScholarì˜ Supervisor Agentë¡œì„œ, ì—¬ëŸ¬ Researcherë“¤ì˜ ê²€ìƒ‰Â·ìš”ì•½ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ê³   
ê° ê²°ê³¼ì˜ í’ˆì§ˆ ë° ê²½í–¥ì„ ë¶„ì„í•œë‹¤.  
ì´ ë‹¨ê³„ì˜ ëª©ì ì€ **ì „ëµì  í†µì°°(Meta Reflection)** ì„ ë„ì¶œí•˜ëŠ” ê²ƒì´ë‹¤.

---

## ì…ë ¥
- **Topic:** {topic}
- **Researcher Reflections:** {reflections_json_list}
  (ê° í•­ëª©ì—ëŠ” faithfulness, relevance, reflection, need_more_search ë“±ì´ í¬í•¨ë¨)
- **Session Plan:** {plan}

---

## ìˆ˜í–‰ ëª©í‘œ
1ï¸âƒ£ ì „ì²´ ë¦¬ì„œì¹˜ì˜ í‰ê·  Faithfulness / Relevance ê³„ì‚°  
2ï¸âƒ£ ê³µí†µ ì‹¤íŒ¨ ì›ì¸ ìš”ì•½ (ì˜ˆ: íŠ¹ì • subtopicì—ì„œ ê²€ìƒ‰ ë¶€ì •í™• ë“±)  
3ï¸âƒ£ ì„±ê³µ íŒ¨í„´ ìš”ì•½ (ì˜ˆ: íŠ¹ì • í‚¤ì›Œë“œë‚˜ ì†ŒìŠ¤ê°€ íš¨ê³¼ì )  
4ï¸âƒ£ ë‹¤ìŒ ì„¸ì…˜ ê°œì„  ì „ëµ ì œì‹œ

---

## ì¶œë ¥ í˜•ì‹ (JSON)
```json
{
  "avg_faithfulness": <float>,
  "avg_relevance": <float>,
  "meta_reflection": "<ì „ëµì  í†µì°° ìš”ì•½>",
  "improvement_plan": "<ë‹¤ìŒ ì„¸ì…˜ì„ ìœ„í•œ ì œì•ˆ>"
}

```

```

---

## ğŸ§© 3ï¸âƒ£ `think_tool_final` â€” **ìµœì¢… Reflect + CaseBank ì €ì¥ (ì¥ê¸° Reflect)**  
> ì„¸ì…˜ ì¢…ë£Œ ì‹œ / Supervisor ë˜ëŠ” Main Agent í˜¸ì¶œ / DBì— ë°˜ì˜ âœ…

```text
# ğŸ§  ThinkTool Final â€” Session-Level Reflect & Memory Persistence

ë„ˆëŠ” AXDeepScholarì˜ Reflect Agentì´ë‹¤.  
ì´ë²ˆ ì„¸ì…˜ ì „ì²´ì˜ ì—°êµ¬ ê²°ê³¼ë¥¼ í‰ê°€í•˜ê³ ,  
Faithfulness / Relevance / Reward / Lessonì„ ì‚°ì¶œí•´ CaseBankì— ì €ì¥í•œë‹¤.

---

## ì…ë ¥
- **Topic:** {topic}
- **Meta Reflection:** {meta_reflection}
- **Improvement Plan:** {improvement_plan}
- **All Researcher Reflections:** {researcher_reflects_json}
- **Session Summary:** {summary}

---

## í‰ê°€ ë‹¨ê³„
1ï¸âƒ£ Faithfulness â€” ì „ì²´ ì„¸ì…˜ì˜ ì •í™•ì„± í‰ê·   
2ï¸âƒ£ Relevance â€” ì£¼ì œ ì í•©ì„± í‰ê·   
3ï¸âƒ£ Reward Score = 0.6Ã—Faith + 0.4Ã—Rel  
4ï¸âƒ£ Success = 1 if Reward â‰¥ 0.75 else 0  
5ï¸âƒ£ Lesson â€” ë‹¤ìŒ ì„¸ì…˜ì— ì ìš©í•  í•µì‹¬ êµí›ˆ í•œ ë¬¸ì¥

---

## ì¶œë ¥ í˜•ì‹ (JSON)
```json
{
  "faithfulness": <float>,
  "relevance": <float>,
  "reward": <float>,
  "success": <0 or 1>,
  "lesson": "<í•µì‹¬ êµí›ˆ>",
  "summary": "<ì„¸ì…˜ ì „ì²´ ì„±ì°° ìš”ì•½>"
}

```

```
from pydantic import BaseModel, Field
from typing import List

# Local Reflect
class LocalReflectInput(BaseModel):
    topic: str
    query: str
    context: str
    summary: str
    tool_trace: List[str]
    reflection: str

# Meta Reflect
class MetaReflectInput(BaseModel):
    topic: str
    reflections_json_list: str  # JSON ë¬¸ìì—´ í˜•íƒœ (ë¦¬ìŠ¤íŠ¸ë¡œ ë“¤ì–´ì˜´)
    plan: str

# Final Reflect
class FinalReflectInput(BaseModel):
    topic: str
    meta_reflection: str
    improvement_plan: str
    researcher_reflects_json: str
    summary: str

```